{{ define "main" }}
  {{/* paginator を最初に定義する。RegularPages を指定すれば確実 */}}
  {{ $paginator := .Paginate (where .RegularPages "Section" "post") }}

  <div class="gallery-wrapper">
    <div class="gallery">
      {{ range $paginator.Pages }}
        <div class="thumbnail"
             data-title="{{ .Title }}"
             data-date="{{ .Date.Format "2006-01-02" }}"
             {{ with .Params.tags }}data-tags="{{ delimit . ", " }}"{{ end }}>
          <img src="{{ .Params.thumbnail }}" alt="{{ .Title }}">

          <div class="hidden-content" style="display:none">
            <h2>{{ .Title }}</h2>
            <div class="post-body"></div>

            {{ with .Params.tags }}
              <div class="tags">
                {{ range . }}
                  <a href="{{ "tags/" | relURL }}{{ . | urlize }}" class="tag-link">#{{ . }}</a>
                {{ end }}
              </div>
            {{ end }}
          </div>
        </div>
      {{ end }}
    </div>

    {{/* ページ送りナビゲーション */}}
    <nav class="pagination">
      {{ if $paginator.HasPrev }}
        <a href="{{ $paginator.Prev.URL }}">← Prev</a>
      {{ end }}

      {{ range $paginator.Pagers }}
        {{ if eq .PageNumber $paginator.PageNumber }}
          <span class="current">{{ .PageNumber }}</span>
        {{ else }}
          <a href="{{ .URL }}">{{ .PageNumber }}</a>
        {{ end }}
      {{ end }}

      {{ if $paginator.HasNext }}
        <a href="{{ $paginator.Next.URL }}">Next →</a>
      {{ end }}
    </nav>
  </div>
{{ end }}
